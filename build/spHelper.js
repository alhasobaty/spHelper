'use strict';var _createClass=function(){function e(e,t){for(var a,l=0;l<t.length;l++)a=t[l],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}();Object.defineProperty(exports,'__esModule',{value:!0});function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}var spHelper=function(){function e(t){_classCallCheck(this,e),this.crossDomain=!1,this.targetSite='',this.appContext={},this.spWeb={},this.initializeOptions(t)}return _createClass(e,[{key:'initializeOptions',value:function t(e){if('undefined'!=typeof e.targetSite&&(this.targetSite=e.targetSite),'undefined'!=typeof e.crossDomain&&!0===e.crossDomain)if(''!==this.targetSite)this.setCrossDomain();else throw'spHelper Error: Configuration error. Cannot set cross domain communication without a target site.';this.setClientContext(),this.setWeb()}},{key:'setCrossDomain',value:function e(){this.crossDomain=!0}},{key:'setClientContext',value:function e(){''!==this.targetSite&&!1===this.crossDomain?this.appContext=new SP.ClientContext(this.targetSite):(this.appContext=new SP.ClientContext.get_current,!0===this.crossDomain&&(this.crossContext=new SP.AppContextSite(this.appContext,this.targetSite)))}},{key:'setWeb',value:function e(){this.spWeb=!0===this.crossDomain?this.crossContext.get_web():this.appContext.get_web()}},{key:'getSiteProperty',value:function s(e,t,i){if('undefined'==typeof e)throw'spHelper Error: Unable to get the site property. Ensure the siteProperty [ARRAY] is correctly configured.';try{this.appContext.load(this.spWeb,e);var a=this,l=function(){var i={};e.includes('Title')&&(i.Title=a.spWeb.get_title()),e.includes('Url')&&(i.Url=a.spWeb.get_url()),e.includes('ServerRelativeUrl')&&(i.ServerRelativeUrl=a.spWeb.get_serverRelativeUrl()),e.includes('MasterUrl')&&(i.MasterUrl=a.spWeb.get_masterUrl()),t(i)},o=function(e,t){i(t.get_message())};this.appContext.executeQueryAsync(l,o)}catch(e){throw'spHelper Error: Unable to get the site property. Validate the request details.'+e}}},{key:'getListData',value:function r(e,t,i){'undefined'==typeof e.pagePosition&&(e.pagePosition=0);var a=[],l=this,o=function(i){a=a.concat(i),5e3==i.length?(5e3==a.length&&++e.pagePosition,e.pagePosition+=5e3,l.loadListData(e,o,s)):t(a)},s=function(e){i(e)};this.loadListData(e,o,s)}},{key:'loadListData',value:function p(e,t,a){if('undefined'==typeof e.listName&&'undefined'==typeof e.listGuid||'undefined'==typeof e.listColumns||'undefined'==typeof e.pagePosition)throw'spHelper Error: Invalid query details. Minimum query details must include list title, columns and page position.';try{var m='';m='undefined'==typeof e.listName?this.spWeb.get_lists().getById(e.listGuid):this.spWeb.get_lists().getByTitle(e.listName);var c=new SP.CamlQuery;if('undefined'!=typeof e.query)c.set_viewXml(e.query);else{var g='<View Scope=\'RecursiveAll\'>';for(var y in g+='<ViewFields>',e.listColumns)g+='<FieldRef Name=\''+e.listColumns[y]+'\' />';if(g+='</ViewFields>','undefined'!=typeof e.where){var l=!1,o=!1,s=0;if('undefined'==typeof e.where.value&&(e.where.value=''),g+='<Query> <Where>','undefined'!=typeof e.where.values)g+='<'+e.where.operation+'>',e.where.values.forEach(function(e){g+='<'+e.operation+'>',g+='lookup'!==e.type.toLowerCase()||isNaN(e.value)?'<FieldRef Name=\''+e.column+'\'/> <Value Type=\''+e.type+'\'>'+e.value+'</Value>':'<FieldRef Name=\''+e.column+'\' LookupId=\'TRUE\'/> <Value Type=\''+e.type+'\'>'+e.value+'</Value>',g+='</'+e.operation+'>'}),g+='</'+e.where.operation+'>';else{if('Array'===e.where.value.constructor.name&&(o=!0),'in'===e.where.operation.toLowerCase()&&o&&60<e.where.value.length&&(l=!0,s=Math.ceil(e.where.value.length/60)),l){g+='<Or>';for(var _=0;_<s;_++)g+='<In> <FieldRef Name=\''+e.where.column+'\' /> <Values>',e.where.value.forEach(function(t){g+='<Value Type=\''+e.where.type+'\'>'+t+'</Value>'}),g+='</Values></In>'}else g+='<'+e.where.operation+'>',o?(g+='lookup'!==e.where.type.toLowerCase()||isNaN(e.where.value[0])?' <FieldRef Name=\''+e.where.column+'\' />':' <FieldRef Name=\''+e.where.column+'\' LookupId=\'TRUE\'/>',g+='<Values>',e.where.value.forEach(function(t){g+='<Value Type=\''+e.where.type+'\'>'+t+'</Value>'}),g+='</Values>'):(g+='undefined'==typeof e.where.type||'lookup'!==e.where.type.toLowerCase()||isNaN(e.where.value)?' <FieldRef Name=\''+e.where.column+'\' />':' <FieldRef Name=\''+e.where.column+'\' LookupId=\'TRUE\'/>','undefined'!=typeof e.where.type&&'undefined'!=typeof e.where.value&&(g+='<Value Type=\''+e.where.type+'\'>'+e.where.value+'</Value>')),g+='</'+e.where.operation+'>';l&&(g+='</Or>')}g+='</Where></Query>'}if('undefined'!=typeof e.join){for(var i in g+='\n                    <Joins>\n                        <Join Type="'+e.join.direction+'" ListAlias="'+e.join.list+'">\n                            <Eq>\n                                <FieldRef Name="'+e.join.joinColumn+'" RefType="Id" />\n                                <FieldRef Name="ID" List="'+e.join.list+'" />\n                            </Eq>\n                        </Join>\n                    </Joins>',g+='<ProjectedFields>',e.join.getColumns)g+='<Field ShowField="'+e.join.getColumns[i]+'" Type="Lookup" Name="'+e.join.getColumns[i]+'" List="'+e.join.list+'" />';g+='</ProjectedFields>'}g+='</View>',c.set_viewXml(g)}var r=new SP.ListItemCollectionPosition;r.set_pagingInfo('Paged=TRUE&p_ID='+e.pagePosition),c.set_listItemCollectionPosition(r);var f=m.getItems(c);this.appContext.load(f,'Include('+e.listColumns.toString()+')');var n=this,u=function(){for(var i=f.getEnumerator(),a=[];i.moveNext();){var l=i.get_current(),o={},s=!0,r=!1,n=void 0;try{for(var u,d,p=e.listColumns[Symbol.iterator]();!(s=(u=p.next()).done);s=!0){d=u.value;try{o[d]=l.get_item(d)}catch(t){if('undefined'!=typeof e.listName)throw'spHelper Error: The column \''+d+'\' requested from \''+e.listName+'\' does not exist! Error: '+t;else throw'spHelper Error: The column \''+d+'\' requested from \''+e.listGuid+'\' does not exist! Error: '+t}}}catch(e){r=!0,n=e}finally{try{!s&&p.return&&p.return()}finally{if(r)throw n}}a.push(o)}t(a)},d=function(e,t){a(t.get_message())};this.appContext.executeQueryAsync(u,d)}catch(e){throw'spHelper Error: Unable to read list data. Validate query details ... '+e}}},{key:'updateListItem',value:function o(e,t,i){if('undefined'==typeof e.listName||'undefined'==typeof e.itemID||'undefined'==typeof e.columnData)throw'spHelper Error: Invalid update details. To update an item, the list name, item ID, and column update data is required.';try{var a=this.spWeb.get_lists().getByTitle(e.listName),l=a.getItemById(e.itemID);for(var s in e.columnData)if('url'==e.columnData[s].Type.toLowerCase())try{var r=new SP.FieldUrlValue;r.set_url(e.columnData[s].URL),r.set_description(e.columnData[s].Description),l.set_item(s,r)}catch(e){throw'spHelper Error: Invalid URL field details. Unable to update item ... '+e}else if('lookup'==e.columnData[s].Type.toLowerCase())try{if(''===e.columnData[s].LookupID)l.set_item(s,null);else if('Array'===e.columnData[s].LookupID.constructor.name)(function(){var t=[];e.columnData[s].LookupID.forEach(function(e){var i=new SP.FieldLookupValue;i.set_lookupId(e),t.push(i)}),l.set_item(s,t)})();else{var n=new SP.FieldLookupValue;n.set_lookupId(e.columnData[s].LookupID),l.set_item(s,n)}}catch(e){throw'spHelper Error: Invalid Lookup field details. Unable to update item ... '+e}else'user'===e.columnData[s].Type.toLowerCase()?function(){var t=[];if('String'===e.columnData[s].Value.constructor.name){var i=new SP.FieldUserValue.fromUser(e.columnData[s].Value);t.push(i)}else e.columnData[s].Value.forEach(function(e){var i=new SP.FieldUserValue.fromUser(e);t.push(i)});l.set_item(s,t)}():l.set_item(s,e.columnData[s].Value);l.update(),this.appContext.executeQueryAsync(t,i)}catch(e){throw'spHelper Error: Unable to update item. Validate update details ... '+e}}},{key:'addListItem',value:function s(e,t,i){if('undefined'==typeof e.listName||'undefined'==typeof e.columnData)throw'spHelper Error: Invalid create item details. To create an item, listName and columnData must be defined.';try{var a=this.spWeb.get_lists().getByTitle(e.listName),l=new SP.ListItemCreationInformation,o=a.addItem(l);for(var r in e.columnData)if('url'===e.columnData[r].Type.toLowerCase())try{var n=new SP.FieldUrlValue;n.set_url(e.columnData[r].URL),n.set_description(e.columnData[r].Description),o.set_item(r,n)}catch(e){throw'spHelper Error: Invalid URL field details. Unable to add item ... '+e}else if('lookup'===e.columnData[r].Type.toLowerCase())try{if('Number'===e.columnData[r].LookupID.constructor.name||'String'===e.columnData[r].LookupID.constructor.name){var u=new SP.FieldLookupValue;u.set_lookupId(e.columnData[r].LookupID),o.set_item(r,u)}else(function(){var t=[];e.columnData[r].LookupID.forEach(function(e){var i=new SP.FieldLookupValue;i.set_lookupId(e),t.push(i)}),o.set_item(r,t)})()}catch(e){throw'spHelper Error: Invalid Lookup field details. Unable to add item ... '+e}else'user'===e.columnData[r].Type.toLowerCase()?function(){var t=[];if('String'===e.columnData[r].Value.constructor.name){var i=new SP.FieldUserValue.fromUser(e.columnData[r].Value);t.push(i)}else e.columnData[r].Value.forEach(function(e){var i=new SP.FieldUserValue.fromUser(e);t.push(i)});o.set_item(r,t)}():o.set_item(r,e.columnData[r].Value);o.update(),this.appContext.executeQueryAsync(function e(){t(o.get_id())},i)}catch(e){throw'SPHelper Error: Unable to add new item. Validate create details ... '+e}}},{key:'addListItemAttachment',value:function s(e,t,i){var a=this.spWeb.get_lists().getByTitle(e.listName);this.appContext.load(a,'RootFolder');var l=a.getItemById(e.itemID);this.appContext.load(l);var o=this;this.appContext.executeQueryAsync(function r(){if(!l.get_fieldValues().Attachments){var t=a.get_rootFolder().get_serverRelativeUrl()+'/Attachments',i=o.spWeb.getFolderByServerRelativeUrl(t),s=i.get_folders().add('_'+e.itemID);s.moveTo(t+'/'+e.itemID),o.appContext.load(s),o.appContext.executeQueryAsync(function(e){console.log(e)},function(e,t){console.log(t.get_message())})}else;},function a(e,t){i(t.get_message())})}},{key:'deleteListItem',value:function o(e,t,i){if('undefined'==typeof e.listName||'undefined'==typeof e.itemID)throw'spHelper Error: Invalid delete details. To update an item, the list name and item ID is required.';try{var a=this.spWeb.get_lists().getByTitle(e.listName),l=a.getItemById(e.itemID);l.deleteObject(),this.appContext.executeQueryAsync(t,i)}catch(e){throw'spHelper Error: Unable to delete item. Validate update details ... '+e}}},{key:'getListContentTypeDefault',value:function n(e,t,i){try{var a=this.spWeb.get_lists().getByTitle(e),l=a.get_contentTypes();this.appContext.load(l);var o=this,s=function(){var e=l.getEnumerator();e.moveNext(),t(e.get_current().get_id().toString())},r=function(e,t){i(t.get_message())};this.appContext.executeQueryAsync(s,r)}catch(e){throw'spHelper Error: Unable to get list default content type ... '+e}}},{key:'getListDetails',value:function r(e,t,i){var a=!(3<arguments.length&&void 0!==arguments[3])||arguments[3];try{var l=this,o=function(i){var o={},r=l.spWeb.get_lists().getByTitle(e),n=r.get_contentTypes(),u=n.getById(i),d=u.get_fields(),p=r.get_rootFolder();l.appContext.load(d),l.appContext.load(r),l.appContext.load(p),l.appContext.load(l.spWeb);l.appContext.executeQueryAsync(function g(){o.settings={},o.settings.id=r.get_id().toString(),o.settings.title=r.get_title(),o.settings.enableAttachments=r.get_enableAttachments(),o.settings.contentTypesEnabled=r.get_contentTypesEnabled(),o.settings.description=r.get_description(),o.settings.enableFolderCreation=r.get_enableFolderCreation(),o.settings.enableMinorVersions=r.get_enableMinorVersions(),o.settings.enableModeration=r.get_enableModeration(),o.settings.enableVersioning=r.get_enableVersioning(),o.settings.forceCheckout=r.get_forceCheckout(),o.settings.parentWebUrl=r.get_parentWebUrl(),o.settings.template=r.get_baseTemplate(),o.settings.rootFolder=p.get_serverRelativeUrl(),o.settings.internalName=p.get_name(),o.settings.serverRelativeURL=100==o.settings.template?l.spWeb.get_url()+'/Lists/'+o.settings.internalName+'/':l.spWeb.get_url()+'/'+o.settings.internalName+'/';var e=d.getEnumerator();for(o.columns=[];e.moveNext();){var i={},s=e.get_current();if('ContentType'!==s.get_internalName()){if(a&&!0===s.get_readOnlyField())continue;i={id:s.get_id().toString(),title:s.get_title(),internalName:s.get_internalName(),default:s.get_defaultValue(),unique:s.get_enforceUniqueValues(),required:s.get_required(),hidden:s.get_hidden(),description:s.get_description(),fieldType:s.get_fieldTypeKind()};var n=new DOMParser,u=s.get_schemaXml(),m=n.parseFromString(u,'text/xml'),c=m.getElementsByTagName('Field')[0].attributes;2===s.get_fieldTypeKind()&&(i.maxLength=s.get_maxLength()),(6===s.get_fieldTypeKind()||15===s.get_fieldTypeKind())&&(i.choices=s.get_choices(),i.fillInChoice=s.get_fillInChoice(),6===s.get_fieldTypeKind()&&(i.editFormat=s.get_editFormat())),3===s.get_fieldTypeKind()&&(i.numberOfLines=s.get_numberOfLines(),i.richText=s.get_richText(),i.appendOnly=s.get_appendOnly()),(9===s.get_fieldTypeKind()||10===s.get_fieldTypeKind())&&(i.minimumValue=s.get_minimumValue(),i.maximumValue=s.get_maximumValue(),9===s.get_fieldTypeKind()&&(i.showAsPercentage='undefined'!=typeof c.Percentage&&'FALSE'!==c.Percentage.value,'undefined'!=typeof c.Decimals&&(i.displayFormat=parseInt(c.Decimals.value))),10===s.get_fieldTypeKind()&&(i.currencyLocaleId=s.get_currencyLocaleId())),4===s.get_fieldTypeKind()&&(i.displayFormat=s.get_displayFormat(),i.friendlyDisplayFormat=s.get_friendlyDisplayFormat()),7===s.get_fieldTypeKind()&&(i.allowMultipleValues=s.get_allowMultipleValues(),i.lookupList=s.get_lookupList(),i.lookupField=s.get_lookupField()),20===s.get_fieldTypeKind()&&(i.allowMultipleValues=s.get_allowMultipleValues()),11===s.get_fieldTypeKind()&&(i.displayFormat=s.get_displayFormat()),17===s.get_fieldTypeKind()&&(i.resultType=c.ResultType.value,'Number'===c.ResultType.value&&(i.displayFormat=c.Decimals.value,i.showAsPercentage=c.Percentage.value),'Currency'===c.ResultType.value&&(i.displayFormat=c.Decimals.value,i.currencyLocaleId=c.LCID.value)),o.columns.push(i)}}t(o)},function i(e,t){s(t.get_message())})},s=function(e){i(e)};this.getListContentTypeDefault(e,o,s)}catch(e){throw'spHelper Error: Unable to get list details ... '+e}}},{key:'getUserProperty',value:function o(e,t,i){if('undefined'==typeof e)throw'spHelper Error: Unable to get the user property. Ensure the userProperty [ARRAY] is correctly configured.';try{var s=this.spWeb.get_currentUser();this.appContext.load(s,e);var a=function(){var i={};e.includes('Title')&&(i.Title=s.get_title()),e.includes('id')&&(i.ID=s.get_id()),e.includes('email')&&(i.Email=s.get_email()),t(i)},l=function(e,t){i(t.get_message())};this.appContext.executeQueryAsync(a,l)}catch(e){throw'spHelper Error: Unable to get the user property. Validate the request details.'+e}}},{key:'searchUsers',value:function s(e,t,i){var a=new SP.UI.ApplicationPages.ClientPeoplePickerQueryParameters;a.set_allowMultipleEntities(!1),a.set_maximumEntitySuggestions(50),a.set_principalType(1),a.set_principalSource(15),a.set_queryString(e);var l=SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.clientPeoplePickerSearchUser(this.appContext,a),o=this;this.appContext.executeQueryAsync(function r(){var e=JSON.parse(l.get_value());if(e){var a=[],s=[];e.forEach(function(e){s.push(new Promise(function(t){o.getUserProfile(e.Description,function i(e){null!==e&&a.push(e),t()},function t(e){i(e)})}))}),Promise.all(s).then(function(){t(a)})}else t(null)},function a(e,t){i(t.get_message())})}},{key:'getUserProfile',value:function o(e,t,i){var a=new SP.UserProfiles.PeopleManager(this.appContext),l=a.getPropertiesFor(e);this.appContext.load(l),this.appContext.executeQueryAsync(function(){try{t(l.get_userProfileProperties())}catch(e){t(null)}},function(e,t){i(t.get_message())})}},{key:'getCurrentUser',value:function l(e,t){var i=new SP.UserProfiles.PeopleManager(this.appContext),a=i.getMyProperties();this.appContext.load(a),this.appContext.executeQueryAsync(function(){try{e(a.get_userProfileProperties())}catch(t){e(null)}},function(e,i){t(i.get_message())})}},{key:'getCurrentUserManager',value:function a(e,t){var i=this;this.getCurrentUser(function l(a){i.getUserProfile(a.Manager,e,t)},function i(e){t(e)})}},{key:'fieldType',value:function t(e){return'String'===e.constructor.name?SP.FieldType[e]:1===e?'integer':2===e?'text':3===e?'note':4===e?'dateTime':5===e?'counter':6===e?'choice':7===e?'lookup':8===e?'boolean':9===e?'number':10===e?'currency':11===e?'URL':12===e?'computed':13===e?'threading':14===e?'guid':15===e?'multiChoice':16===e?'gridChoice':17===e?'calculated':18===e?'file':19===e?'attachments':20===e?'user':21===e?'recurrence':22===e?'crossProjectLink':23===e?'modStat':24===e?'error':25===e?'contentTypeId':26===e?'pageSeparator':27===e?'threadIndex':28===e?'workflowStatus':29===e?'allDayEvent':30===e?'workflowEventType':31===e?'maxItems':void 0}},{key:'dateType',value:function t(e){return SP.DateTimeFieldFormatType[e]}},{key:'numberFormatType',value:function t(e){return'automatic'===e.toLowerCase()?'undefined':'nodecimal'===e.toLowerCase()?0:'onedecimal'===e.toLowerCase()?1:'twodecimals'===e.toLowerCase()?2:'threedecimals'===e.toLowerCase()?3:'fourdecimals'===e.toLowerCase()?4:'fivedecimals'===e.toLowerCase()?5:void 0}},{key:'canReadList',value:function o(e,t,i){if('undefined'==typeof e)throw'spHelper Error: Invalid can read list details. To check access a libraryName must be defined.';try{var s=this.spWeb.get_lists().getByTitle(e);this.appContext.load(s);var a=function(){t()},l=function(){i()};this.appContext.executeQueryAsync(a,l)}catch(e){throw'spHelper Error: Unable to validate user permissions for list ... '+e}}},{key:'canWriteList',value:function o(e,t,i){if('undefined'==typeof e)throw'spHelper Error: Invalid can write list details. To check access a libraryName must be defined.';try{var s=this.spWeb.get_lists().getByTitle(e);this.appContext.load(s,'EffectiveBasePermissions');var a=function(){s.get_effectiveBasePermissions().has(SP.PermissionKind.editListItems)?t():i()},l=function(){i()};this.appContext.executeQueryAsync(a,l)}catch(e){throw'spHelper Error: Unable to validate user permissions for list ... '+e}}},{key:'canDeleteList',value:function o(e,t,i){if('undefined'==typeof e)throw'spHelper Error: Invalid can delete list details. To check access a libraryName must be defined.';try{var s=this.spWeb.get_lists().getByTitle(e);this.appContext.load(s,'EffectiveBasePermissions');var a=function(){s.get_effectiveBasePermissions().has(SP.PermissionKind.deleteListItems)?t():i()},l=function(){i()};this.appContext.executeQueryAsync(a,l)}catch(e){throw'spHelper Error: Unable to validate user permissions for list ... '+e}}},{key:'hasListAccess',value:function s(e,t,i,a){if('undefined'==typeof e||'undefined'==typeof t)throw'spHelper Error: Invalid has list access details. To check access, libraryName and permissionType must be defined.';try{var r=this.spWeb.get_lists().getByTitle(e);this.appContext.load(r,'EffectiveBasePermissions');var l=function(){r.get_effectiveBasePermissions().has(SP.PermissionKind[t])?i():a()},o=function(){a()};this.appContext.executeQueryAsync(l,o)}catch(e){throw'spHelper Error: Unable to validate user permissions ... '+e}}},{key:'spRibbon',value:function e(){return{removeEdit:function t(){var e=new Promise(function(e,t){ExecuteOrDelayUntilScriptLoaded(function(){var i=3,a=!1,l=function(){try{var l=SP.Ribbon.PageManager.get_instance().get_ribbon();l?(!!l.getChildByTitle('Edit')&&l.removeChild('Ribbon.ListForm.Edit'),l.selectTabById('Ribbon.Read'),a=!0,e()):!a&&0<i?(setTimeout(startRemove,200),i--):t('Unable to remove the edit tab (Ribbon took to long to load). Try refreshing this page.')}catch(e){t(e)}};l()},'sp.ui.dialog.js')});return e}}}},{key:'spModalDialog',value:function e(){return{isActive:function t(){var e=new Promise(function(e,t){ExecuteOrDelayUntilScriptLoaded(function(){try{var i=SP.UI.ModalDialog.get_childDialog();i?e(!0):e(!1)}catch(e){t(e)}},'sp.ui.dialog.js')});return e},resize:function t(){var e=new Promise(function(e,t){ExecuteOrDelayUntilScriptLoaded(function(){var i=3,a=!1,l=function(){try{var o=SP.UI.ModalDialog.get_childDialog();o&&null!==o.$e_0?(!o.$Q_0&&o.autoSize(),a=!0,e()):!a&&0<i?(setTimeout(l,200),i--):t('Unable to resize the modal dialog (Took to long to load). Try refreshing this window.')}catch(e){t(e)}};l()},'sp.ui.dialog.js')});return e},close:function e(){ExecuteOrDelayUntilScriptLoaded(function(){var e=3,t=function(){try{var i=SP.UI.ModalDialog.get_childDialog();i?i.close():0<e&&(setTimeout(t,200),e--)}catch(e){console.log(e)}};t()},'sp.ui.dialog.js')},setTitle:function i(e){var t=new Promise(function(t,i){ExecuteOrDelayUntilScriptLoaded(function(){var a=3,l=!1,o=function(){try{var s=SP.UI.ModalDialog.get_childDialog();s&&null!==s.$e_0?(SP.UI.UIUtility.setInnerText(parent.document.getElementById('dialogTitleSpan'),e),l=!0,t()):!l&&0<a?(setTimeout(o,200),a--):i('Unable to set SharePoint Modal Title (Took to long to load). Try refreshing this window.')}catch(e){i(e)}};o()},'sp.ui.dialog.js')});return t}}}}]),e}();exports.default=spHelper;