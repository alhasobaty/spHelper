'use strict';var _createClass=function(){function e(e,t){for(var a,o=0;o<t.length;o++)a=t[o],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}();Object.defineProperty(exports,'__esModule',{value:!0});function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}var spHelper=function(){function e(t){_classCallCheck(this,e),this.crossDomain=!1,this.targetSite='',this.appContext={},this.spWeb={},this.initializeOptions(t)}return _createClass(e,[{key:'initializeOptions',value:function t(e){if('undefined'!=typeof e.targetSite&&(this.targetSite=e.targetSite),'undefined'!=typeof e.crossDomain&&!0===e.crossDomain)if(''!==this.targetSite)this.setCrossDomain();else throw'spHelper Error: Configuration error. Cannot set cross domain communication without a target site.';this.setClientContext(),this.setWeb()}},{key:'setCrossDomain',value:function e(){this.crossDomain=!0}},{key:'setClientContext',value:function e(){''!==this.targetSite&&!1===this.crossDomain?this.appContext=new SP.ClientContext(this.targetSite):(this.appContext=new SP.ClientContext.get_current,!0===this.crossDomain&&(this.crossContext=new SP.AppContextSite(this.appContext,this.targetSite)))}},{key:'setWeb',value:function e(){this.spWeb=!0===this.crossDomain?this.crossContext.get_web():this.appContext.get_web()}},{key:'refreshConnection',value:function e(){this.setClientContext(),this.setWeb()}},{key:'getSiteProperty',value:function n(e,t,i){if('undefined'==typeof e)throw'spHelper Error: Unable to get the site property. Ensure the siteProperty [ARRAY] is correctly configured.';try{this.refreshConnection(),this.appContext.load(this.spWeb,e);var a=this,o=function(){var i={};e.includes('Title')&&(i.Title=a.spWeb.get_title()),e.includes('Url')&&(i.Url=a.spWeb.get_url()),e.includes('ServerRelativeUrl')&&(i.ServerRelativeUrl=a.spWeb.get_serverRelativeUrl()),e.includes('MasterUrl')&&(i.MasterUrl=a.spWeb.get_masterUrl()),t(i)},l=function(e,t){i(t.get_message())};this.appContext.executeQueryAsync(o,l)}catch(e){throw'spHelper Error: Unable to get the site property. Validate the request details.'+e}}},{key:'getListData',value:function r(e,t,i){'undefined'==typeof e.pagePosition&&(e.pagePosition=0),this.refreshConnection();var a=[],o=this,l=function(i){a=a.concat(i),5e3==i.length?(5e3==a.length&&++e.pagePosition,e.pagePosition+=5e3,o.loadListData(e,l,n)):t(a)},n=function(e){i(e)};this.loadListData(e,l,n)}},{key:'loadListData',value:function p(e,t,a){if('undefined'==typeof e.listName&&'undefined'==typeof e.listGuid||'undefined'==typeof e.listColumns||'undefined'==typeof e.pagePosition)throw'spHelper Error: Invalid query details. Minimum query details must include list title, columns and page position.';try{var c='';c='undefined'==typeof e.listName?this.spWeb.get_lists().getById(e.listGuid):this.spWeb.get_lists().getByTitle(e.listName);var m=new SP.CamlQuery;if('undefined'!=typeof e.query)m.set_viewXml(e.query);else{var g='<View Scope=\'RecursiveAll\'>';for(var y in g+='<ViewFields>',e.listColumns)g+='<FieldRef Name=\''+e.listColumns[y]+'\' />';if(g+='</ViewFields>','undefined'!=typeof e.where){var o=!1,l=!1,n=0;if('undefined'==typeof e.where.value&&(e.where.value=''),g+='<Query> <Where>','undefined'!=typeof e.where.values)g+='<'+e.where.operation+'>',e.where.values.forEach(function(e){g+='<'+e.operation+'>',g+='lookup'!==e.type.toLowerCase()||isNaN(e.value)?'<FieldRef Name=\''+e.column+'\'/> <Value Type=\''+e.type+'\'>'+e.value+'</Value>':'<FieldRef Name=\''+e.column+'\' LookupId=\'TRUE\'/> <Value Type=\''+e.type+'\'>'+e.value+'</Value>',g+='</'+e.operation+'>'}),g+='</'+e.where.operation+'>';else{if('Array'===e.where.value.constructor.name&&(l=!0),'in'===e.where.operation.toLowerCase()&&l&&60<e.where.value.length&&(o=!0,n=Math.ceil(e.where.value.length/60)),o){g+='<Or>';for(var f=0;f<n;f++)g+='<In> <FieldRef Name=\''+e.where.column+'\' /> <Values>',e.where.value.forEach(function(t){g+='<Value Type=\''+e.where.type+'\'>'+t+'</Value>'}),g+='</Values></In>'}else g+='<'+e.where.operation+'>',l?(g+='lookup'!==e.where.type.toLowerCase()||isNaN(e.where.value[0])?' <FieldRef Name=\''+e.where.column+'\' />':' <FieldRef Name=\''+e.where.column+'\' LookupId=\'TRUE\'/>',g+='<Values>',e.where.value.forEach(function(t){g+='<Value Type=\''+e.where.type+'\'>'+t+'</Value>'}),g+='</Values>'):(g+='undefined'==typeof e.where.type||'lookup'!==e.where.type.toLowerCase()||isNaN(e.where.value)?' <FieldRef Name=\''+e.where.column+'\' />':' <FieldRef Name=\''+e.where.column+'\' LookupId=\'TRUE\'/>','undefined'!=typeof e.where.type&&'undefined'!=typeof e.where.value&&(g+='<Value Type=\''+e.where.type+'\'>'+e.where.value+'</Value>')),g+='</'+e.where.operation+'>';o&&(g+='</Or>')}g+='</Where></Query>'}if('undefined'!=typeof e.join){for(var i in g+='\n                    <Joins>\n                        <Join Type="'+e.join.direction+'" ListAlias="'+e.join.list+'">\n                            <Eq>\n                                <FieldRef Name="'+e.join.joinColumn+'" RefType="Id" />\n                                <FieldRef Name="ID" List="'+e.join.list+'" />\n                            </Eq>\n                        </Join>\n                    </Joins>',g+='<ProjectedFields>',e.join.getColumns)g+='<Field ShowField="'+e.join.getColumns[i]+'" Type="Lookup" Name="'+e.join.getColumns[i]+'" List="'+e.join.list+'" />';g+='</ProjectedFields>'}g+='</View>',m.set_viewXml(g)}var r=new SP.ListItemCollectionPosition;r.set_pagingInfo('Paged=TRUE&p_ID='+e.pagePosition),m.set_listItemCollectionPosition(r);var _=c.getItems(m);this.appContext.load(_,'Include('+e.listColumns.toString()+')');var s=this,u=function(){for(var i=_.getEnumerator(),a=[];i.moveNext();){var o=i.get_current(),l={},n=!0,r=!1,s=void 0;try{for(var u,d,p=e.listColumns[Symbol.iterator]();!(n=(u=p.next()).done);n=!0){d=u.value;try{l[d]=o.get_item(d)}catch(t){if('undefined'!=typeof e.listName)throw'spHelper Error: The column \''+d+'\' requested from \''+e.listName+'\' does not exist! Error: '+t;else throw'spHelper Error: The column \''+d+'\' requested from \''+e.listGuid+'\' does not exist! Error: '+t}}}catch(e){r=!0,s=e}finally{try{!n&&p.return&&p.return()}finally{if(r)throw s}}a.push(l)}t(a)},d=function(e,t){a(t.get_message())};this.appContext.executeQueryAsync(u,d)}catch(e){throw'spHelper Error: Unable to read list data. Validate query details ... '+e}}},{key:'updateListItem',value:function l(e,t,i){if('undefined'==typeof e.listName||'undefined'==typeof e.itemID||'undefined'==typeof e.columnData)throw'spHelper Error: Invalid update details. To update an item, the list name, item ID, and column update data is required.';try{this.refreshConnection();var a=this.spWeb.get_lists().getByTitle(e.listName),o=a.getItemById(e.itemID);for(var n in e.columnData)if('url'==e.columnData[n].Type.toLowerCase())try{var r=new SP.FieldUrlValue;r.set_url(e.columnData[n].URL),r.set_description(e.columnData[n].Description),o.set_item(n,r)}catch(e){throw'spHelper Error: Invalid URL field details. Unable to update item ... '+e}else if('lookup'==e.columnData[n].Type.toLowerCase())try{if(''===e.columnData[n].LookupID)o.set_item(n,null);else if('Array'===e.columnData[n].LookupID.constructor.name)(function(){var t=[];e.columnData[n].LookupID.forEach(function(e){var i=new SP.FieldLookupValue;i.set_lookupId(e),t.push(i)}),o.set_item(n,t)})();else{var s=new SP.FieldLookupValue;s.set_lookupId(e.columnData[n].LookupID),o.set_item(n,s)}}catch(e){throw'spHelper Error: Invalid Lookup field details. Unable to update item ... '+e}else'user'===e.columnData[n].Type.toLowerCase()?function(){var t=[];if('String'===e.columnData[n].Value.constructor.name){var i=new SP.FieldUserValue.fromUser(e.columnData[n].Value);t.push(i)}else e.columnData[n].Value.forEach(function(e){var i=new SP.FieldUserValue.fromUser(e);t.push(i)});o.set_item(n,t)}():o.set_item(n,e.columnData[n].Value);o.update(),this.appContext.executeQueryAsync(t,i)}catch(e){throw'spHelper Error: Unable to update item. Validate update details ... '+e}}},{key:'addListItem',value:function n(e,t,i){if('undefined'==typeof e.listName||'undefined'==typeof e.columnData)throw'spHelper Error: Invalid create item details. To create an item, listName and columnData must be defined.';try{this.refreshConnection();var a=this.spWeb.get_lists().getByTitle(e.listName),o=new SP.ListItemCreationInformation,l=a.addItem(o);for(var r in e.columnData)if('url'===e.columnData[r].Type.toLowerCase())try{var s=new SP.FieldUrlValue;s.set_url(e.columnData[r].URL),s.set_description(e.columnData[r].Description),l.set_item(r,s)}catch(e){throw'spHelper Error: Invalid URL field details. Unable to add item ... '+e}else if('lookup'===e.columnData[r].Type.toLowerCase())try{if('Number'===e.columnData[r].LookupID.constructor.name||'String'===e.columnData[r].LookupID.constructor.name){var u=new SP.FieldLookupValue;u.set_lookupId(e.columnData[r].LookupID),l.set_item(r,u)}else(function(){var t=[];e.columnData[r].LookupID.forEach(function(e){var i=new SP.FieldLookupValue;i.set_lookupId(e),t.push(i)}),l.set_item(r,t)})()}catch(e){throw'spHelper Error: Invalid Lookup field details. Unable to add item ... '+e}else'user'===e.columnData[r].Type.toLowerCase()?function(){var t=[];if('String'===e.columnData[r].Value.constructor.name){var i=new SP.FieldUserValue.fromUser(e.columnData[r].Value);t.push(i)}else e.columnData[r].Value.forEach(function(e){var i=new SP.FieldUserValue.fromUser(e);t.push(i)});l.set_item(r,t)}():l.set_item(r,e.columnData[r].Value);l.update(),this.appContext.executeQueryAsync(function e(){t(l.get_id())},i)}catch(e){throw'SPHelper Error: Unable to add new item. Validate create details ... '+e}}},{key:'addListItemAttachment',value:function n(e,t,i){this.refreshConnection();var a=this.spWeb.get_lists().getByTitle(e.listName);this.appContext.load(a,'RootFolder');var o=a.getItemById(e.itemID);this.appContext.load(o);var l=this;this.appContext.executeQueryAsync(function r(){if(!o.get_fieldValues().Attachments){var t=a.get_rootFolder().get_serverRelativeUrl()+'/Attachments',i=l.spWeb.getFolderByServerRelativeUrl(t),n=i.get_folders().add('_'+e.itemID);n.moveTo(t+'/'+e.itemID),l.appContext.load(n),l.appContext.executeQueryAsync(function(e){console.log(e)},function(e,t){console.log(t.get_message())})}else;},function a(e,t){i(t.get_message())})}},{key:'deleteListItem',value:function l(e,t,i){if('undefined'==typeof e.listName||'undefined'==typeof e.itemID)throw'spHelper Error: Invalid delete details. To update an item, the list name and item ID is required.';try{this.refreshConnection();var a=this.spWeb.get_lists().getByTitle(e.listName),o=a.getItemById(e.itemID);o.deleteObject(),this.appContext.executeQueryAsync(t,i)}catch(e){throw'spHelper Error: Unable to delete item. Validate update details ... '+e}}},{key:'getListContentTypeDefault',value:function s(e,t,i){try{this.refreshConnection();var a=this.spWeb.get_lists().getByTitle(e),o=a.get_contentTypes();this.appContext.load(o);var l=this,n=function(){var e=o.getEnumerator();e.moveNext(),t(e.get_current().get_id().toString())},r=function(e,t){i(t.get_message())};this.appContext.executeQueryAsync(n,r)}catch(e){throw'spHelper Error: Unable to get list default content type ... '+e}}},{key:'getListDetails',value:function r(e,t,i){var a=!(3<arguments.length&&void 0!==arguments[3])||arguments[3];try{this.refreshConnection();var o=this,l=function(i){var l={},r=o.spWeb.get_lists().getByTitle(e),s=r.get_contentTypes(),u=s.getById(i),d=u.get_fields(),p=r.get_rootFolder();o.appContext.load(d),o.appContext.load(r),o.appContext.load(p),o.appContext.load(o.spWeb);o.appContext.executeQueryAsync(function g(){l.settings={},l.settings.id=r.get_id().toString(),l.settings.title=r.get_title(),l.settings.enableAttachments=r.get_enableAttachments(),l.settings.contentTypesEnabled=r.get_contentTypesEnabled(),l.settings.description=r.get_description(),l.settings.enableFolderCreation=r.get_enableFolderCreation(),l.settings.enableMinorVersions=r.get_enableMinorVersions(),l.settings.enableModeration=r.get_enableModeration(),l.settings.enableVersioning=r.get_enableVersioning(),l.settings.forceCheckout=r.get_forceCheckout(),l.settings.parentWebUrl=r.get_parentWebUrl(),l.settings.template=r.get_baseTemplate(),l.settings.rootFolder=p.get_serverRelativeUrl(),l.settings.internalName=p.get_name(),l.settings.serverRelativeURL=100==l.settings.template?o.spWeb.get_url()+'/Lists/'+l.settings.internalName+'/':o.spWeb.get_url()+'/'+l.settings.internalName+'/';var e=d.getEnumerator();for(l.columns=[];e.moveNext();){var i={},n=e.get_current();if('ContentType'!==n.get_internalName()){if(a&&!0===n.get_readOnlyField())continue;i={id:n.get_id().toString(),title:n.get_title(),internalName:n.get_internalName(),default:n.get_defaultValue(),unique:n.get_enforceUniqueValues(),required:n.get_required(),hidden:n.get_hidden(),description:n.get_description(),fieldType:n.get_fieldTypeKind()};var s=new DOMParser,u=n.get_schemaXml(),c=s.parseFromString(u,'text/xml'),m=c.getElementsByTagName('Field')[0].attributes;2===n.get_fieldTypeKind()&&(i.maxLength=n.get_maxLength()),(6===n.get_fieldTypeKind()||15===n.get_fieldTypeKind())&&(i.choices=n.get_choices(),i.fillInChoice=n.get_fillInChoice(),6===n.get_fieldTypeKind()&&(i.editFormat=n.get_editFormat())),3===n.get_fieldTypeKind()&&(i.numberOfLines=n.get_numberOfLines(),i.richText=n.get_richText(),i.appendOnly=n.get_appendOnly()),(9===n.get_fieldTypeKind()||10===n.get_fieldTypeKind())&&(i.minimumValue=n.get_minimumValue(),i.maximumValue=n.get_maximumValue(),9===n.get_fieldTypeKind()&&(i.showAsPercentage='undefined'!=typeof m.Percentage&&'FALSE'!==m.Percentage.value,'undefined'!=typeof m.Decimals&&(i.displayFormat=parseInt(m.Decimals.value))),10===n.get_fieldTypeKind()&&(i.currencyLocaleId=n.get_currencyLocaleId())),4===n.get_fieldTypeKind()&&(i.displayFormat=n.get_displayFormat(),i.friendlyDisplayFormat=n.get_friendlyDisplayFormat()),7===n.get_fieldTypeKind()&&(i.allowMultipleValues=n.get_allowMultipleValues(),i.lookupList=n.get_lookupList(),i.lookupField=n.get_lookupField()),20===n.get_fieldTypeKind()&&(i.allowMultipleValues=n.get_allowMultipleValues()),11===n.get_fieldTypeKind()&&(i.displayFormat=n.get_displayFormat()),17===n.get_fieldTypeKind()&&(i.resultType=m.ResultType.value,'Number'===m.ResultType.value&&(i.displayFormat=m.Decimals.value,i.showAsPercentage=m.Percentage.value),'Currency'===m.ResultType.value&&(i.displayFormat=m.Decimals.value,i.currencyLocaleId=m.LCID.value)),l.columns.push(i)}}t(l)},function i(e,t){n(t.get_message())})},n=function(e){i(e)};this.getListContentTypeDefault(e,l,n)}catch(e){throw'spHelper Error: Unable to get list details ... '+e}}},{key:'getUserProperty',value:function l(e,t,i){if('undefined'==typeof e)throw'spHelper Error: Unable to get the user property. Ensure the userProperty [ARRAY] is correctly configured.';try{this.refreshConnection();var n=this.spWeb.get_currentUser();this.appContext.load(n,e);var a=function(){var i={};e.includes('Title')&&(i.Title=n.get_title()),e.includes('id')&&(i.ID=n.get_id()),e.includes('email')&&(i.Email=n.get_email()),t(i)},o=function(e,t){i(t.get_message())};this.appContext.executeQueryAsync(a,o)}catch(e){throw'spHelper Error: Unable to get the user property. Validate the request details.'+e}}},{key:'searchUsers',value:function n(e,t,i){this.refreshConnection();var a=new SP.UI.ApplicationPages.ClientPeoplePickerQueryParameters;a.set_allowMultipleEntities(!1),a.set_maximumEntitySuggestions(50),a.set_principalType(1),a.set_principalSource(15),a.set_queryString(e);var o=SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.clientPeoplePickerSearchUser(this.appContext,a),l=this;this.appContext.executeQueryAsync(function r(){var e=JSON.parse(o.get_value());if(e){var a=[],n=[];e.forEach(function(e){n.push(new Promise(function(t){l.getUserProfile(e.Description,function i(e){null!==e&&a.push(e),t()},function t(e){i(e)})}))}),Promise.all(n).then(function(){t(a)})}else t(null)},function a(e,t){i(t.get_message())})}},{key:'getUserProfile',value:function l(e,t,i){this.refreshConnection();var a=new SP.UserProfiles.PeopleManager(this.appContext),o=a.getPropertiesFor(e);this.appContext.load(o),this.appContext.executeQueryAsync(function(){try{t(o.get_userProfileProperties())}catch(e){t(null)}},function(e,t){i(t.get_message())})}},{key:'getCurrentUser',value:function o(e,t){this.refreshConnection();var i=new SP.UserProfiles.PeopleManager(this.appContext),a=i.getMyProperties();this.appContext.load(a),this.appContext.executeQueryAsync(function(){try{e(a.get_userProfileProperties())}catch(t){e(null)}},function(e,i){t(i.get_message())})}},{key:'getCurrentUserManager',value:function a(e,t){this.refreshConnection();var i=this;this.getCurrentUser(function o(a){i.getUserProfile(a.Manager,e,t)},function i(e){t(e)})}},{key:'fieldType',value:function t(e){return'String'===e.constructor.name?SP.FieldType[e]:1===e?'integer':2===e?'text':3===e?'note':4===e?'dateTime':5===e?'counter':6===e?'choice':7===e?'lookup':8===e?'boolean':9===e?'number':10===e?'currency':11===e?'URL':12===e?'computed':13===e?'threading':14===e?'guid':15===e?'multiChoice':16===e?'gridChoice':17===e?'calculated':18===e?'file':19===e?'attachments':20===e?'user':21===e?'recurrence':22===e?'crossProjectLink':23===e?'modStat':24===e?'error':25===e?'contentTypeId':26===e?'pageSeparator':27===e?'threadIndex':28===e?'workflowStatus':29===e?'allDayEvent':30===e?'workflowEventType':31===e?'maxItems':void 0}},{key:'dateType',value:function t(e){return SP.DateTimeFieldFormatType[e]}},{key:'numberFormatType',value:function t(e){return'automatic'===e.toLowerCase()?'undefined':'nodecimal'===e.toLowerCase()?0:'onedecimal'===e.toLowerCase()?1:'twodecimals'===e.toLowerCase()?2:'threedecimals'===e.toLowerCase()?3:'fourdecimals'===e.toLowerCase()?4:'fivedecimals'===e.toLowerCase()?5:void 0}},{key:'canReadList',value:function l(e,t,i){if('undefined'==typeof e)throw'spHelper Error: Invalid can read list details. To check access a libraryName must be defined.';try{this.refreshConnection();var n=this.spWeb.get_lists().getByTitle(e);this.appContext.load(n);var a=function(){t()},o=function(){i()};this.appContext.executeQueryAsync(a,o)}catch(e){throw'spHelper Error: Unable to validate user permissions for list ... '+e}}},{key:'canWriteList',value:function l(e,t,i){if('undefined'==typeof e)throw'spHelper Error: Invalid can write list details. To check access a libraryName must be defined.';try{this.refreshConnection();var n=this.spWeb.get_lists().getByTitle(e);this.appContext.load(n,'EffectiveBasePermissions');var a=function(){n.get_effectiveBasePermissions().has(SP.PermissionKind.editListItems)?t():i()},o=function(){i()};this.appContext.executeQueryAsync(a,o)}catch(e){throw'spHelper Error: Unable to validate user permissions for list ... '+e}}},{key:'canDeleteList',value:function l(e,t,i){if('undefined'==typeof e)throw'spHelper Error: Invalid can delete list details. To check access a libraryName must be defined.';try{this.refreshConnection();var n=this.spWeb.get_lists().getByTitle(e);this.appContext.load(n,'EffectiveBasePermissions');var a=function(){n.get_effectiveBasePermissions().has(SP.PermissionKind.deleteListItems)?t():i()},o=function(){i()};this.appContext.executeQueryAsync(a,o)}catch(e){throw'spHelper Error: Unable to validate user permissions for list ... '+e}}},{key:'hasListAccess',value:function n(e,t,i,a){if('undefined'==typeof e||'undefined'==typeof t)throw'spHelper Error: Invalid has list access details. To check access, libraryName and permissionType must be defined.';try{this.refreshConnection();var r=this.spWeb.get_lists().getByTitle(e);this.appContext.load(r,'EffectiveBasePermissions');var o=function(){r.get_effectiveBasePermissions().has(SP.PermissionKind[t])?i():a()},l=function(){a()};this.appContext.executeQueryAsync(o,l)}catch(e){throw'spHelper Error: Unable to validate user permissions ... '+e}}},{key:'spRibbon',value:function e(){return{removeEdit:function t(){var e=new Promise(function(e,t){ExecuteOrDelayUntilScriptLoaded(function(){var i=3,a=!1,o=function(){try{var o=SP.Ribbon.PageManager.get_instance().get_ribbon();o?(!!o.getChildByTitle('Edit')&&o.removeChild('Ribbon.ListForm.Edit'),o.selectTabById('Ribbon.Read'),a=!0,e()):!a&&0<i?(setTimeout(startRemove,200),i--):t('Unable to remove the edit tab (Ribbon took to long to load). Try refreshing this page.')}catch(e){t(e)}};o()},'sp.ui.dialog.js')});return e}}}},{key:'spModalDialog',value:function e(){return{isActive:function t(){var e=new Promise(function(e,t){ExecuteOrDelayUntilScriptLoaded(function(){try{var i=SP.UI.ModalDialog.get_childDialog();i?e(!0):e(!1)}catch(e){t(e)}},'sp.ui.dialog.js')});return e},resize:function t(){var e=new Promise(function(e,t){ExecuteOrDelayUntilScriptLoaded(function(){var i=3,a=!1,o=function(){try{var l=SP.UI.ModalDialog.get_childDialog();l&&null!==l.$e_0?(!l.$Q_0&&l.autoSize(),a=!0,e()):!a&&0<i?(setTimeout(o,200),i--):t('Unable to resize the modal dialog (Took to long to load). Try refreshing this window.')}catch(e){t(e)}};o()},'sp.ui.dialog.js')});return e},close:function e(){ExecuteOrDelayUntilScriptLoaded(function(){var e=3,t=function(){try{var i=SP.UI.ModalDialog.get_childDialog();i?i.close():0<e&&(setTimeout(t,200),e--)}catch(e){console.log(e)}};t()},'sp.ui.dialog.js')},setTitle:function i(e){var t=new Promise(function(t,i){ExecuteOrDelayUntilScriptLoaded(function(){var a=3,o=!1,l=function(){try{var n=SP.UI.ModalDialog.get_childDialog();n&&null!==n.$e_0?(SP.UI.UIUtility.setInnerText(parent.document.getElementById('dialogTitleSpan'),e),o=!0,t()):!o&&0<a?(setTimeout(l,200),a--):i('Unable to set SharePoint Modal Title (Took to long to load). Try refreshing this window.')}catch(e){i(e)}};l()},'sp.ui.dialog.js')});return t}}}}]),e}();exports.default=spHelper;