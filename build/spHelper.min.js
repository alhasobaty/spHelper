'use strict';var _createClass=function(){function e(e,t){for(var a,o=0;o<t.length;o++)a=t[o],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}();Object.defineProperty(exports,'__esModule',{value:!0});function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}var spHelper=function(){function e(t){_classCallCheck(this,e),this.crossDomain=!1,this.targetSite='',this.appContext={},this.spWeb={},this.initializeOptions(t)}return _createClass(e,[{key:'initializeOptions',value:function initializeOptions(e){if('undefined'!=typeof e.targetSite&&(this.targetSite=e.targetSite),'undefined'!=typeof e.crossDomain&&!0===e.crossDomain)if(''!==this.targetSite)this.setCrossDomain();else throw'spHelper Error: Configuration error. Cannot set cross domain communication without a target site.';this.setClientContext(),this.setWeb()}},{key:'setCrossDomain',value:function setCrossDomain(){this.crossDomain=!0}},{key:'setClientContext',value:function setClientContext(){''!==this.targetSite&&!1===this.crossDomain?this.appContext=new SP.ClientContext(this.targetSite):(this.appContext=new SP.ClientContext.get_current,!0===this.crossDomain&&(this.crossContext=new SP.AppContextSite(this.appContext,this.targetSite)))}},{key:'setWeb',value:function setWeb(){this.spWeb=!0===this.crossDomain?this.crossContext.get_web():this.appContext.get_web()}},{key:'refreshConnection',value:function refreshConnection(){this.setClientContext(),this.setWeb()}},{key:'getSiteProperty',value:function getSiteProperty(e,t,i){if('undefined'==typeof e)throw'spHelper Error: Unable to get the site property. Ensure the siteProperty [ARRAY] is correctly configured.';try{this.refreshConnection(),this.appContext.load(this.spWeb,e);var a=this;this.appContext.executeQueryAsync(function resolve(){var i={};e.includes('Title')&&(i.Title=a.spWeb.get_title()),e.includes('Url')&&(i.Url=a.spWeb.get_url()),e.includes('ServerRelativeUrl')&&(i.ServerRelativeUrl=a.spWeb.get_serverRelativeUrl()),e.includes('MasterUrl')&&(i.MasterUrl=a.spWeb.get_masterUrl()),t(i)},function _reject(e,t){i(t.get_message())})}catch(e){throw'spHelper Error: Unable to get the site property. Validate the request details.'+e}}},{key:'getListData',value:function getListData(e,t,i){'undefined'==typeof e.pagePosition&&(e.pagePosition=0),this.refreshConnection();var a=[],o=this,l=function(i){a=a.concat(i),5e3==i.length?(5e3==a.length&&++e.pagePosition,e.pagePosition+=5e3,o.loadListData(e,l,n)):t(a)},n=function(e){i(e)};this.loadListData(e,l,n)}},{key:'loadListData',value:function loadListData(e,t,a){if('undefined'==typeof e.listName&&'undefined'==typeof e.listGuid||'undefined'==typeof e.listColumns||'undefined'==typeof e.pagePosition)throw'spHelper Error: Invalid query details. Minimum query details must include list title, columns and page position.';try{var l='';l='undefined'==typeof e.listName?this.spWeb.get_lists().getById(e.listGuid):this.spWeb.get_lists().getByTitle(e.listName);var n=new SP.CamlQuery;if('undefined'!=typeof e.query)n.set_viewXml(e.query);else{var r='<View Scope=\'RecursiveAll\'>';for(var s in r+='<ViewFields>',e.listColumns)r+='<FieldRef Name=\''+e.listColumns[s]+'\' />';if(r+='</ViewFields>','undefined'!=typeof e.where){var u=!1,d=!1,p=0;if('undefined'==typeof e.where.value&&(e.where.value=''),r+='<Query> <Where>','undefined'!=typeof e.where.values)r+='<'+e.where.operation+'>',e.where.values.forEach(function(e){r+='<'+e.operation+'>',r+='lookup'!==e.type.toLowerCase()||isNaN(e.value)?'<FieldRef Name=\''+e.column+'\'/> <Value Type=\''+e.type+'\'>'+e.value+'</Value>':'<FieldRef Name=\''+e.column+'\' LookupId=\'TRUE\'/> <Value Type=\''+e.type+'\'>'+e.value+'</Value>',r+='</'+e.operation+'>'}),r+='</'+e.where.operation+'>';else{if('Array'===e.where.value.constructor.name&&(d=!0),'in'===e.where.operation.toLowerCase()&&d&&60<e.where.value.length&&(u=!0,p=Math.ceil(e.where.value.length/60)),u){r+='<Or>';for(var c=0;c<p;c++)r+='<In> <FieldRef Name=\''+e.where.column+'\' /> <Values>',e.where.value.forEach(function(t){r+='<Value Type=\''+e.where.type+'\'>'+t+'</Value>'}),r+='</Values></In>'}else r+='<'+e.where.operation+'>',d?(r+='lookup'!==e.where.type.toLowerCase()||isNaN(e.where.value[0])?' <FieldRef Name=\''+e.where.column+'\' />':' <FieldRef Name=\''+e.where.column+'\' LookupId=\'TRUE\'/>',r+='<Values>',e.where.value.forEach(function(t){r+='<Value Type=\''+e.where.type+'\'>'+t+'</Value>'}),r+='</Values>'):(r+='undefined'==typeof e.where.type||'lookup'!==e.where.type.toLowerCase()||isNaN(e.where.value)?' <FieldRef Name=\''+e.where.column+'\' />':' <FieldRef Name=\''+e.where.column+'\' LookupId=\'TRUE\'/>','undefined'!=typeof e.where.type&&'undefined'!=typeof e.where.value&&(r+='<Value Type=\''+e.where.type+'\'>'+e.where.value+'</Value>')),r+='</'+e.where.operation+'>';u&&(r+='</Or>')}r+='</Where></Query>'}if('undefined'!=typeof e.join){for(var i in r+='\n                    <Joins>\n                        <Join Type="'+e.join.direction+'" ListAlias="'+e.join.list+'">\n                            <Eq>\n                                <FieldRef Name="'+e.join.joinColumn+'" RefType="Id" />\n                                <FieldRef Name="ID" List="'+e.join.list+'" />\n                            </Eq>\n                        </Join>\n                    </Joins>',r+='<ProjectedFields>',e.join.getColumns)r+='<Field ShowField="'+e.join.getColumns[i]+'" Type="Lookup" Name="'+e.join.getColumns[i]+'" List="'+e.join.list+'" />';r+='</ProjectedFields>'}r+='</View>',n.set_viewXml(r)}var o=new SP.ListItemCollectionPosition;o.set_pagingInfo('Paged=TRUE&p_ID='+e.pagePosition),n.set_listItemCollectionPosition(o);var m=l.getItems(n);this.appContext.load(m,'Include('+e.listColumns.toString()+')');var g=this;this.appContext.executeQueryAsync(function resolve(){for(var l=m.getEnumerator(),n=[];l.moveNext();){var r=l.get_current(),s={},u=!0,d=!1,p=void 0;try{for(var i,a,o=e.listColumns[Symbol.iterator]();!(u=(i=o.next()).done);u=!0){a=i.value;try{s[a]=r.get_item(a)}catch(t){if('undefined'!=typeof e.listName)throw'spHelper Error: The column \''+a+'\' requested from \''+e.listName+'\' does not exist! Error: '+t;else throw'spHelper Error: The column \''+a+'\' requested from \''+e.listGuid+'\' does not exist! Error: '+t}}}catch(e){d=!0,p=e}finally{try{!u&&o.return&&o.return()}finally{if(d)throw p}}n.push(s)}t(returnedItems)},function _reject2(e,t){a(t.get_message())})}catch(e){throw'spHelper Error: Unable to read list data. Validate query details ... '+e}}},{key:'updateListItem',value:function updateListItem(e,t,i){if('undefined'==typeof e.listName||'undefined'==typeof e.itemID||'undefined'==typeof e.columnData)throw'spHelper Error: Invalid update details. To update an item, the list name, item ID, and column update data is required.';try{this.refreshConnection();var a=this.spWeb.get_lists().getByTitle(e.listName),o=a.getItemById(e.itemID);for(var l in e.columnData)if('url'==e.columnData[l].Type.toLowerCase())try{var n=new SP.FieldUrlValue;n.set_url(e.columnData[l].URL),n.set_description(e.columnData[l].Description),o.set_item(l,n)}catch(e){throw'spHelper Error: Invalid URL field details. Unable to update item ... '+e}else if('lookup'==e.columnData[l].Type.toLowerCase())try{if(''===e.columnData[l].LookupID)o.set_item(l,null);else if('Array'===e.columnData[l].LookupID.constructor.name)(function(){var t=[];e.columnData[l].LookupID.forEach(function(e){var i=new SP.FieldLookupValue;i.set_lookupId(e),t.push(i)}),o.set_item(l,t)})();else{var r=new SP.FieldLookupValue;r.set_lookupId(e.columnData[l].LookupID),o.set_item(l,r)}}catch(e){throw'spHelper Error: Invalid Lookup field details. Unable to update item ... '+e}else'user'===e.columnData[l].Type.toLowerCase()?function(){var t=[];if('String'===e.columnData[l].Value.constructor.name){var i=new SP.FieldUserValue.fromUser(e.columnData[l].Value);t.push(i)}else e.columnData[l].Value.forEach(function(e){var i=new SP.FieldUserValue.fromUser(e);t.push(i)});o.set_item(l,t)}():o.set_item(l,e.columnData[l].Value);o.update(),this.appContext.executeQueryAsync(t,i)}catch(e){throw'spHelper Error: Unable to update item. Validate update details ... '+e}}},{key:'addListItem',value:function addListItem(e,t,i){if('undefined'==typeof e.listName||'undefined'==typeof e.columnData)throw'spHelper Error: Invalid create item details. To create an item, listName and columnData must be defined.';try{this.refreshConnection();var a=this.spWeb.get_lists().getByTitle(e.listName),o=new SP.ListItemCreationInformation,l=a.addItem(o);for(var n in e.columnData)if('url'===e.columnData[n].Type.toLowerCase())try{var r=new SP.FieldUrlValue;r.set_url(e.columnData[n].URL),r.set_description(e.columnData[n].Description),l.set_item(n,r)}catch(e){throw'spHelper Error: Invalid URL field details. Unable to add item ... '+e}else if('lookup'===e.columnData[n].Type.toLowerCase())try{if('Number'===e.columnData[n].LookupID.constructor.name||'String'===e.columnData[n].LookupID.constructor.name){var s=new SP.FieldLookupValue;s.set_lookupId(e.columnData[n].LookupID),l.set_item(n,s)}else(function(){var t=[];e.columnData[n].LookupID.forEach(function(e){var i=new SP.FieldLookupValue;i.set_lookupId(e),t.push(i)}),l.set_item(n,t)})()}catch(e){throw'spHelper Error: Invalid Lookup field details. Unable to add item ... '+e}else'user'===e.columnData[n].Type.toLowerCase()?function(){var t=[];if('String'===e.columnData[n].Value.constructor.name){var i=new SP.FieldUserValue.fromUser(e.columnData[n].Value);t.push(i)}else e.columnData[n].Value.forEach(function(e){var i=new SP.FieldUserValue.fromUser(e);t.push(i)});l.set_item(n,t)}():l.set_item(n,e.columnData[n].Value);l.update(),this.appContext.executeQueryAsync(function onLocalSuccess(){t(l.get_id())},i)}catch(e){throw'SPHelper Error: Unable to add new item. Validate create details ... '+e}}},{key:'addListItemAttachment',value:function addListItemAttachment(e,t,i){this.refreshConnection();var a=this.spWeb.get_lists().getByTitle(e.listName);this.appContext.load(a,'RootFolder');var o=a.getItemById(e.itemID);this.appContext.load(o);var l=this;this.appContext.executeQueryAsync(function onLoadDetailsSuccess(){if(!o.get_fieldValues().Attachments){var t=a.get_rootFolder().get_serverRelativeUrl()+'/Attachments',i=l.spWeb.getFolderByServerRelativeUrl(t),n=i.get_folders().add('_'+e.itemID);n.moveTo(t+'/'+e.itemID),l.appContext.load(n),l.appContext.executeQueryAsync(function(e){console.log(e)},function(e,t){console.log(t.get_message())})}else;},function onLoadDetailsFailure(e,t){i(t.get_message())})}},{key:'deleteListItem',value:function deleteListItem(e,t,i){if('undefined'==typeof e.listName||'undefined'==typeof e.itemID)throw'spHelper Error: Invalid delete details. To update an item, the list name and item ID is required.';try{this.refreshConnection();var a=this.spWeb.get_lists().getByTitle(e.listName),o=a.getItemById(e.itemID);o.deleteObject(),this.appContext.executeQueryAsync(t,i)}catch(e){throw'spHelper Error: Unable to delete item. Validate update details ... '+e}}},{key:'getListContentTypeDefault',value:function getListContentTypeDefault(e,t,i){try{this.refreshConnection();var a=this.spWeb.get_lists().getByTitle(e),o=a.get_contentTypes();this.appContext.load(o);var l=this;this.appContext.executeQueryAsync(function resolve(){var e=o.getEnumerator();e.moveNext(),t(e.get_current().get_id().toString())},function _reject3(e,t){i(t.get_message())})}catch(e){throw'spHelper Error: Unable to get list default content type ... '+e}}},{key:'getListDetails',value:function getListDetails(e,t,i){var a=!(3<arguments.length&&void 0!==arguments[3])||arguments[3];try{this.refreshConnection();var o=this,l=function(e){i(e)};this.getListContentTypeDefault(e,function getLibraryDetails(i){var n={},r=o.spWeb.get_lists().getByTitle(e),s=r.get_contentTypes(),u=s.getById(i),d=u.get_fields(),p=r.get_rootFolder();o.appContext.load(d),o.appContext.load(r),o.appContext.load(p),o.appContext.load(o.spWeb);o.appContext.executeQueryAsync(function resolve(){n.settings={},n.settings.id=r.get_id().toString(),n.settings.title=r.get_title(),n.settings.enableAttachments=r.get_enableAttachments(),n.settings.contentTypesEnabled=r.get_contentTypesEnabled(),n.settings.description=r.get_description(),n.settings.enableFolderCreation=r.get_enableFolderCreation(),n.settings.enableMinorVersions=r.get_enableMinorVersions(),n.settings.enableModeration=r.get_enableModeration(),n.settings.enableVersioning=r.get_enableVersioning(),n.settings.forceCheckout=r.get_forceCheckout(),n.settings.parentWebUrl=r.get_parentWebUrl(),n.settings.template=r.get_baseTemplate(),n.settings.rootFolder=p.get_serverRelativeUrl(),n.settings.internalName=p.get_name(),n.settings.serverRelativeURL=100==n.settings.template?o.spWeb.get_url()+'/Lists/'+n.settings.internalName+'/':o.spWeb.get_url()+'/'+n.settings.internalName+'/';var e=d.getEnumerator();for(n.columns=[];e.moveNext();){var i={},l=e.get_current();if('ContentType'!==l.get_internalName()){if(a&&!0===l.get_readOnlyField())continue;i={id:l.get_id().toString(),title:l.get_title(),internalName:l.get_internalName(),default:l.get_defaultValue(),unique:l.get_enforceUniqueValues(),required:l.get_required(),hidden:l.get_hidden(),description:l.get_description(),fieldType:l.get_fieldTypeKind()};var s=new DOMParser,u=l.get_schemaXml(),c=s.parseFromString(u,'text/xml'),m=c.getElementsByTagName('Field')[0].attributes;2===l.get_fieldTypeKind()&&(i.maxLength=l.get_maxLength()),(6===l.get_fieldTypeKind()||15===l.get_fieldTypeKind())&&(i.choices=l.get_choices(),i.fillInChoice=l.get_fillInChoice(),6===l.get_fieldTypeKind()&&(i.editFormat=l.get_editFormat())),3===l.get_fieldTypeKind()&&(i.numberOfLines=l.get_numberOfLines(),i.richText=l.get_richText(),i.appendOnly=l.get_appendOnly()),(9===l.get_fieldTypeKind()||10===l.get_fieldTypeKind())&&(i.minimumValue=l.get_minimumValue(),i.maximumValue=l.get_maximumValue(),9===l.get_fieldTypeKind()&&(i.showAsPercentage='undefined'!=typeof m.Percentage&&'FALSE'!==m.Percentage.value,'undefined'!=typeof m.Decimals&&(i.displayFormat=parseInt(m.Decimals.value))),10===l.get_fieldTypeKind()&&(i.currencyLocaleId=l.get_currencyLocaleId())),4===l.get_fieldTypeKind()&&(i.displayFormat=l.get_displayFormat(),i.friendlyDisplayFormat=l.get_friendlyDisplayFormat()),7===l.get_fieldTypeKind()&&(i.allowMultipleValues=l.get_allowMultipleValues(),i.lookupList=l.get_lookupList(),i.lookupField=l.get_lookupField()),20===l.get_fieldTypeKind()&&(i.allowMultipleValues=l.get_allowMultipleValues()),11===l.get_fieldTypeKind()&&(i.displayFormat=l.get_displayFormat()),17===l.get_fieldTypeKind()&&(i.resultType=m.ResultType.value,'Number'===m.ResultType.value&&(i.displayFormat=m.Decimals.value,i.showAsPercentage=m.Percentage.value),'Currency'===m.ResultType.value&&(i.displayFormat=m.Decimals.value,i.currencyLocaleId=m.LCID.value)),n.columns.push(i)}}t(n)},function reject(e,t){l(t.get_message())})},l)}catch(e){throw'spHelper Error: Unable to get list details ... '+e}}},{key:'getUserProperty',value:function getUserProperty(e,t,i){if('undefined'==typeof e)throw'spHelper Error: Unable to get the user property. Ensure the userProperty [ARRAY] is correctly configured.';try{this.refreshConnection();var a=this.spWeb.get_currentUser();this.appContext.load(a,e);this.appContext.executeQueryAsync(function resolve(){var i={};e.includes('Title')&&(i.Title=a.get_title()),e.includes('id')&&(i.ID=a.get_id()),e.includes('email')&&(i.Email=a.get_email()),t(i)},function _reject4(e,t){i(t.get_message())})}catch(e){throw'spHelper Error: Unable to get the user property. Validate the request details.'+e}}},{key:'searchUsers',value:function searchUsers(e,t,i){this.refreshConnection();var a=new SP.UI.ApplicationPages.ClientPeoplePickerQueryParameters;a.set_allowMultipleEntities(!1),a.set_maximumEntitySuggestions(50),a.set_principalType(1),a.set_principalSource(15),a.set_queryString(e);var o=SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.clientPeoplePickerSearchUser(this.appContext,a),l=this;this.appContext.executeQueryAsync(function resolve(){var e=JSON.parse(o.get_value());if(e){var a=[],n=[];e.forEach(function(e){n.push(new Promise(function(t){l.getUserProfile(e.Description,function buildUserList(e){null!==e&&a.push(e),t()},function displayError(e){i(e)})}))}),Promise.all(n).then(function(){t(a)})}else t(null)},function reject(e,t){i(t.get_message())})}},{key:'getUserProfile',value:function getUserProfile(e,t,i){this.refreshConnection();var a=new SP.UserProfiles.PeopleManager(this.appContext),o=a.getPropertiesFor(e);this.appContext.load(o),this.appContext.executeQueryAsync(function(){try{t(o.get_userProfileProperties())}catch(e){t(null)}},function(e,t){i(t.get_message())})}},{key:'getCurrentUser',value:function getCurrentUser(e,t){this.refreshConnection();var i=new SP.UserProfiles.PeopleManager(this.appContext),a=i.getMyProperties();this.appContext.load(a),this.appContext.executeQueryAsync(function(){try{e(a.get_userProfileProperties())}catch(t){e(null)}},function(e,i){t(i.get_message())})}},{key:'getCurrentUserManager',value:function getCurrentUserManager(e,t){this.refreshConnection();var i=this;this.getCurrentUser(function onSuccessCurrent(a){i.getUserProfile(a.Manager,e,t)},function onFailureCurrent(e){t(e)})}},{key:'fieldType',value:function fieldType(e){return'String'===e.constructor.name?SP.FieldType[e]:1===e?'integer':2===e?'text':3===e?'note':4===e?'dateTime':5===e?'counter':6===e?'choice':7===e?'lookup':8===e?'boolean':9===e?'number':10===e?'currency':11===e?'URL':12===e?'computed':13===e?'threading':14===e?'guid':15===e?'multiChoice':16===e?'gridChoice':17===e?'calculated':18===e?'file':19===e?'attachments':20===e?'user':21===e?'recurrence':22===e?'crossProjectLink':23===e?'modStat':24===e?'error':25===e?'contentTypeId':26===e?'pageSeparator':27===e?'threadIndex':28===e?'workflowStatus':29===e?'allDayEvent':30===e?'workflowEventType':31===e?'maxItems':void 0}},{key:'dateType',value:function dateType(e){return SP.DateTimeFieldFormatType[e]}},{key:'numberFormatType',value:function numberFormatType(e){return'automatic'===e.toLowerCase()?'undefined':'nodecimal'===e.toLowerCase()?0:'onedecimal'===e.toLowerCase()?1:'twodecimals'===e.toLowerCase()?2:'threedecimals'===e.toLowerCase()?3:'fourdecimals'===e.toLowerCase()?4:'fivedecimals'===e.toLowerCase()?5:void 0}},{key:'canReadList',value:function canReadList(e,t,i){if('undefined'==typeof e)throw'spHelper Error: Invalid can read list details. To check access a libraryName must be defined.';try{this.refreshConnection();var a=this.spWeb.get_lists().getByTitle(e);this.appContext.load(a);this.appContext.executeQueryAsync(function resolve(){t()},function _reject5(){i()})}catch(e){throw'spHelper Error: Unable to validate user permissions for list ... '+e}}},{key:'canWriteList',value:function canWriteList(e,t,i){if('undefined'==typeof e)throw'spHelper Error: Invalid can write list details. To check access a libraryName must be defined.';try{this.refreshConnection();var a=this.spWeb.get_lists().getByTitle(e);this.appContext.load(a,'EffectiveBasePermissions');this.appContext.executeQueryAsync(function resolve(){a.get_effectiveBasePermissions().has(SP.PermissionKind.editListItems)?t():i()},function _reject6(){i()})}catch(e){throw'spHelper Error: Unable to validate user permissions for list ... '+e}}},{key:'canDeleteList',value:function canDeleteList(e,t,i){if('undefined'==typeof e)throw'spHelper Error: Invalid can delete list details. To check access a libraryName must be defined.';try{this.refreshConnection();var a=this.spWeb.get_lists().getByTitle(e);this.appContext.load(a,'EffectiveBasePermissions');this.appContext.executeQueryAsync(function resolve(){a.get_effectiveBasePermissions().has(SP.PermissionKind.deleteListItems)?t():i()},function _reject7(){i()})}catch(e){throw'spHelper Error: Unable to validate user permissions for list ... '+e}}},{key:'hasListAccess',value:function hasListAccess(e,t,i,a){if('undefined'==typeof e||'undefined'==typeof t)throw'spHelper Error: Invalid has list access details. To check access, libraryName and permissionType must be defined.';try{this.refreshConnection();var o=this.spWeb.get_lists().getByTitle(e);this.appContext.load(o,'EffectiveBasePermissions');this.appContext.executeQueryAsync(function resolve(){o.get_effectiveBasePermissions().has(SP.PermissionKind[t])?i():a()},function _reject8(){a()})}catch(e){throw'spHelper Error: Unable to validate user permissions ... '+e}}},{key:'spRibbon',value:function spRibbon(){return{removeEdit:function removeEdit(){var e=new Promise(function(e,t){ExecuteOrDelayUntilScriptLoaded(function(){var i=3,a=!1,o=function(){try{var o=SP.Ribbon.PageManager.get_instance().get_ribbon();o?(!!o.getChildByTitle('Edit')&&o.removeChild('Ribbon.ListForm.Edit'),o.selectTabById('Ribbon.Read'),a=!0,e()):!a&&0<i?(setTimeout(startRemove,200),i--):t('Unable to remove the edit tab (Ribbon took to long to load). Try refreshing this page.')}catch(e){t(e)}};o()},'sp.ui.dialog.js')});return e}}}},{key:'spModalDialog',value:function spModalDialog(){return{isActive:function isActive(){var e=new Promise(function(e,t){ExecuteOrDelayUntilScriptLoaded(function(){try{var i=SP.UI.ModalDialog.get_childDialog();i?e(!0):e(!1)}catch(e){t(e)}},'sp.ui.dialog.js')});return e},resize:function resize(){var e=new Promise(function(e,t){ExecuteOrDelayUntilScriptLoaded(function(){var i=3,a=!1,o=function(){try{var l=SP.UI.ModalDialog.get_childDialog();l&&null!==l.$e_0?(!l.$Q_0&&l.autoSize(),a=!0,e()):!a&&0<i?(setTimeout(o,200),i--):t('Unable to resize the modal dialog (Took to long to load). Try refreshing this window.')}catch(e){t(e)}};o()},'sp.ui.dialog.js')});return e},close:function close(){ExecuteOrDelayUntilScriptLoaded(function(){var e=3,t=function(){try{var i=SP.UI.ModalDialog.get_childDialog();i?i.close():0<e&&(setTimeout(t,200),e--)}catch(e){console.log(e)}};t()},'sp.ui.dialog.js')},setTitle:function setTitle(e){var t=new Promise(function(t,i){ExecuteOrDelayUntilScriptLoaded(function(){var a=3,o=!1,l=function(){try{var n=SP.UI.ModalDialog.get_childDialog();n&&null!==n.$e_0?(SP.UI.UIUtility.setInnerText(parent.document.getElementById('dialogTitleSpan'),e),o=!0,t()):!o&&0<a?(setTimeout(l,200),a--):i('Unable to set SharePoint Modal Title (Took to long to load). Try refreshing this window.')}catch(e){i(e)}};l()},'sp.ui.dialog.js')});return t}}}}]),e}();exports.default=spHelper;
